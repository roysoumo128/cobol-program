       IDENTIFICATION DIVISION.
       PROGRAM-ID. EMPSLIP.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT EMP-IN  ASSIGN TO 'EMP.INPUT'
               ORGANIZATION IS SEQUENTIAL.
           SELECT EMP-OUT ASSIGN TO 'EMP.REPORT'
               ORGANIZATION IS SEQUENTIAL.

       DATA DIVISION.
       FILE SECTION.
       FD EMP-IN.
       01 IN-REC.
          05 IN-EMP-ID    PIC X(5).
          05 IN-SP1       PIC X.
          05 IN-NAME      PIC X(15).
          05 IN-SP2       PIC X.
          05 IN-BASIC     PIC 9(6).
          05 IN-FILLER    PIC X(47).

       FD EMP-OUT.
       01 OUT-REC PIC X(100).

       WORKING-STORAGE SECTION.
       77 WS-EOF          PIC X VALUE 'N'.

       01 WS-CNT.
          05 WS-COUNT      PIC 9(6) VALUE 0.

       01 WS-AMTS.
          05 WS-BASIC      PIC 9(8) VALUE 0.
          05 WS-HRA        PIC 9(8) VALUE 0.
          05 WS-DA         PIC 9(8) VALUE 0.
          05 WS-GROSS      PIC 9(9) VALUE 0.
          05 WS-TOTAL-GROSS PIC 9(10) VALUE 0.

       * Edited/display fields (for nicer report alignment)
       01 TXT.
          05 TXT-BASIC     PIC X(8).
          05 TXT-HRA       PIC X(8).
          05 TXT-DA        PIC X(8).
          05 TXT-GROSS     PIC X(10).

       PROCEDURE DIVISION.
       MAIN-LOGIC.
           OPEN INPUT EMP-IN
                OUTPUT EMP-OUT

           PERFORM UNTIL WS-EOF = 'Y'
               READ EMP-IN
                 AT END
                    MOVE 'Y' TO WS-EOF
                 NOT AT END
                    PERFORM PROCESS-EMP
               END-READ
           END-PERFORM

           PERFORM WRITE-SUMMARY

           CLOSE EMP-IN EMP-OUT
           DISPLAY 'EMPSLIP DONE. Employees=' WS-COUNT
                   ' TotalPayout=' WS-TOTAL-GROSS
           STOP RUN.

       PROCESS-EMP.
           * move numeric basic into working storage to be safe
           MOVE IN-BASIC TO WS-BASIC

           * calculate HRA = 20% of BASIC, DA = 10% of BASIC (integer arithmetic)
           COMPUTE WS-HRA   = (WS-BASIC * 20) / 100
           COMPUTE WS-DA    = (WS-BASIC * 10) / 100
           COMPUTE WS-GROSS = WS-BASIC + WS-HRA + WS-DA

           ADD WS-GROSS TO WS-TOTAL-GROSS
           ADD 1 TO WS-COUNT

           * Prepare text versions (COBOL will convert numeric to character when using STRING)
           MOVE SPACES TO TXT-BASIC TXT-HRA TXT-DA TXT-GROSS
           STRING
               WS-BASIC DELIMITED BY SIZE
               INTO TXT-BASIC
           END-STRING
           STRING
               WS-HRA DELIMITED BY SIZE
               INTO TXT-HRA
           END-STRING
           STRING
               WS-DA DELIMITED BY SIZE
               INTO TXT-DA
           END-STRING
           STRING
               WS-GROSS DELIMITED BY SIZE
               INTO TXT-GROSS
           END-STRING

           * Build output line: ID NAME BASIC HRA DA GROSS
           MOVE SPACES TO OUT-REC
           STRING
               IN-EMP-ID DELIMITED BY SIZE
               ' '        DELIMITED BY SIZE
               IN-NAME    DELIMITED BY SIZE
               '  BASIC=' DELIMITED BY SIZE
               TXT-BASIC  DELIMITED BY SIZE
               ' HRA='    DELIMITED BY SIZE
               TXT-HRA    DELIMITED BY SIZE
               ' DA='     DELIMITED BY SIZE
               TXT-DA     DELIMITED BY SIZE
               ' GROSS='  DELIMITED BY SIZE
               TXT-GROSS  DELIMITED BY SIZE
               INTO OUT-REC
           END-STRING

           WRITE OUT-REC.

       WRITE-SUMMARY.
           MOVE SPACES TO OUT-REC
           STRING '-----------------------------------------------' DELIMITED BY SIZE
                  INTO OUT-REC
           END-STRING
           WRITE OUT-REC

           MOVE SPACES TO OUT-REC
           STRING 'TOTAL EMPLOYEES = ' DELIMITED BY SIZE
                  WS-COUNT DELIMITED BY SIZE
                  '  TOTAL PAYOUT = ' DELIMITED BY SIZE
                  WS-TOTAL-GROSS DELIMITED BY SIZE
                  INTO OUT-REC
           END-STRING
           WRITE OUT-REC.
